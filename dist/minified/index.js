const LocalStoragePro=require("local-storage-pro"),jstz=require("locale-util/data/jstz"),timezonesByCountry=require("locale-util/data/extra/timezonesByCountry.json"),countryOfficialLanguages=require("locale-util/data/extra/countryOfficialLanguages.json"),callingCodesByCountry=require("locale-util/data/core/phoneNumberMetadata.json"),currencyCodesByCountry=require("locale-util/data/extra/currencyCodesByCountry.json");function Region(){this.i18nData={timezonesByCountry:timezonesByCountry,countryOfficialLanguages:countryOfficialLanguages,callingCodesByCountry:callingCodesByCountry,currencyCodesByCountry:currencyCodesByCountry},this.jstz=jstz,this.store=new LocalStoragePro,this.storeKeyName="region",this.prevParams=null,this.timezone=null,this.country=null,this.nativeLanguage=null,this.preferredLanguage=null,this.currency=null,this.callingCode=null,this.locale=null,this.locales=[],this.languages=[]}Region.prototype.guess=function(){this.parse();const a=this.store.getItem(this.storeKeyName);a&&(this.prevParams=JSON.parse(a)),this.store.setItem(this.storeKeyName,JSON.stringify(this.get()))},Region.prototype.get=function(){return{timezone:this.timezone,country:this.country,nativeLanguage:this.nativeLanguage,preferredLanguage:this.preferredLanguage,currency:this.currency,callingCode:this.callingCode,locale:this.locale,locales:this.locales,languages:this.languages}},Region.prototype.isTimezoneChanged=function(){return!!this.prevParams&&!!this.prevParams.timezone&&!("string"!=typeof this.prevParams.timezone||"string"!=typeof this.timezone||this.prevParams.timezone==this.timezone)},Region.prototype.isLocaleChanged=function(){return!!this.prevParams&&!!this.prevParams.locale&&!("string"!=typeof this.prevParams.locale||"string"!=typeof this.locale||this.prevParams.locale==this.locale)},Region.prototype.parse=function(){const a=this.jstz.determine().name();"string"==typeof a&&0<a.length&&(this.timezone=a);let b=[];if("languages"in window.navigator)0<window.navigator.languages.length&&(b=window.navigator.languages);else if(window.navigator.language)b.push(window.navigator.language);else if(window.navigator.userLanguage)b.push(window.navigator.userLanguage);else return;if(1>b.length)return;const c=[],d=[];for(var e=0;e<b.length;e++){const a=b[e].split("-");1===a.length?c.push(a[0].toLowerCase()):1<a.length&&(c.push(a[0].toLowerCase()),d.push(a[0].toLowerCase()+"-"+a[1].toUpperCase()),!this.country&&(this.country=a[1].toUpperCase()))}if(0<c.length&&(this.preferredLanguage=c[0],this.nativeLanguage=c[0],this.languages=c),0<d.length&&(this.locales=d),this.timezone){const a=this.timezone,b=a.toLowerCase(),{timezonesByCountry:c}=this.i18nData,d=Object.keys(c).filter(function(a){const d=c[a].filter(a=>a.toLowerCase()==b);return d&&0<d.length});d&&0<d.length&&(this.country=d[0])}if(this.country&&this.languages){const a=this.country,{countryOfficialLanguages:b}=this.i18nData;if(b[a]){const c=b[a],d=c[0];-1!==this.languages.indexOf(d)&&(this.nativeLanguage=d)}this.locale=(this.nativeLanguage||this.preferredLanguage)+"-"+this.country}return this.country&&this.i18nData.callingCodesByCountry.hasOwnProperty(this.country)&&(this.callingCode=this.i18nData.callingCodesByCountry[this.country]),void(this.country&&this.i18nData.currencyCodesByCountry.hasOwnProperty(this.country)&&(this.currency=this.i18nData.currencyCodesByCountry[this.country]))},module.exports=Region;